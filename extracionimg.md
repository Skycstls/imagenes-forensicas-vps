# Informe de extraccion

## Información General

- Fecha y hora de la extracción 
**2025-04-03 17:40:00**

- Responsable de la extracción
**JUAN MANUEL HERRERA**

- Motivo de la extracción
**Perdida de información**

## Descripción del VPS

- IP pública
**157.230.28.241**

- IP privada
**10.114.0.3**

- Sistema Operativo y version
**Ubuntu 24.10**

- Recursos Asignados
**512 MB / 1 CPU /10 GB SSD Disk/500 GB transfer**


- Aplicaciones o servicios en ejecucion

```plaintext
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.2  3.0  22904 14476 ?        Rs   14:59   0:03 /sbin/init
root           2  0.0  0.0      0     0 ?        S    14:59   0:00 [kthreadd]
root           3  0.0  0.0      0     0 ?        S    14:59   0:00 [pool_workqueue_re
root           4  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-rcu_gp]
root           5  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-sync_wq
root           6  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-slub_fl
root           7  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-netns]
root           9  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/0:0H-kblo
root          10  0.0  0.0      0     0 ?        I    14:59   0:00 [kworker/0:1-cgrou
root          11  0.0  0.0      0     0 ?        I    14:59   0:00 [kworker/u4:0-even
root          12  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-mm_perc
root          13  0.0  0.0      0     0 ?        I    14:59   0:00 [rcu_tasks_kthread
root          14  0.0  0.0      0     0 ?        I    14:59   0:00 [rcu_tasks_rude_kt
root          15  0.0  0.0      0     0 ?        I    14:59   0:00 [rcu_tasks_trace_k
root          16  0.0  0.0      0     0 ?        S    14:59   0:00 [ksoftirqd/0]
root          17  0.0  0.0      0     0 ?        R    14:59   0:00 [rcu_preempt]
root          18  0.0  0.0      0     0 ?        S    14:59   0:00 [rcu_exp_par_gp_kt
root          19  0.0  0.0      0     0 ?        S    14:59   0:00 [rcu_exp_gp_kthrea
root          20  0.0  0.0      0     0 ?        S    14:59   0:00 [migration/0]
root          21  0.0  0.0      0     0 ?        S    14:59   0:00 [idle_inject/0]
root          22  0.0  0.0      0     0 ?        S    14:59   0:00 [cpuhp/0]
root          23  0.0  0.0      0     0 ?        S    14:59   0:00 [kdevtmpfs]
root          24  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-inet_fr
root          25  0.0  0.0      0     0 ?        I    14:59   0:00 [kworker/u4:1-even
root          26  0.0  0.0      0     0 ?        S    14:59   0:00 [kauditd]
root          27  0.0  0.0      0     0 ?        S    14:59   0:00 [khungtaskd]
root          28  0.0  0.0      0     0 ?        S    14:59   0:00 [oom_reaper]
root          30  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-writeba
root          31  0.0  0.0      0     0 ?        S    14:59   0:00 [kcompactd0]
root          32  0.0  0.0      0     0 ?        SN   14:59   0:00 [ksmd]
root          33  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-kintegr
root          34  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-kblockd
root          35  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-blkcg_p
root          36  0.0  0.0      0     0 ?        S    14:59   0:00 [irq/9-acpi]
root          37  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-tpm_dev
root          38  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-ata_sff
root          39  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-md]
root          40  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-md_bitm
root          41  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-edac-po
root          42  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-devfreq
root          43  0.0  0.0      0     0 ?        S    14:59   0:00 [watchdogd]
root          44  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/0:1H]
root          45  0.0  0.0      0     0 ?        S    14:59   0:00 [kswapd0]
root          46  0.0  0.0      0     0 ?        S    14:59   0:00 [ecryptfs-kthread]
root          47  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-kthrotl
root          48  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-acpi_th
root          49  0.0  0.0      0     0 ?        S    14:59   0:00 [scsi_eh_0]
root          50  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-scsi_tm
root          51  0.0  0.0      0     0 ?        S    14:59   0:00 [scsi_eh_1]
root          52  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-scsi_tm
root          53  0.0  0.0      0     0 ?        S    14:59   0:00 [scsi_eh_2]
root          54  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-scsi_tm
root          56  0.0  0.0      0     0 ?        I    14:59   0:00 [kworker/u4:4-even
root          57  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-mld]
root          58  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-ipv6_ad
root          65  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-kstrp]
root          67  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/u5:0]
root          72  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-cryptd]
root          81  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-charger
root         164  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-raid5wq
root         201  0.0  0.0      0     0 ?        S    14:59   0:00 [jbd2/vda1-8]
root         202  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-ext4-rs
root         277  0.0  2.2  41500 10600 ?        S<s  14:59   0:00 /usr/lib/systemd/s
root         308  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-kmpathd
root         311  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-kmpath_
root         332  0.0  5.4 287176 25380 ?        SLsl 14:59   0:00 /sbin/multipathd -
root         413  0.0  0.0      0     0 ?        S    14:59   0:00 [jbd2/vda13-8]
root         414  0.0  0.0      0     0 ?        I<   14:59   0:00 [kworker/R-ext4-rs
systemd+     455  0.0  2.1  21280  9980 ?        Ss   14:59   0:00 /usr/lib/systemd/s
systemd+     456  0.0  1.6  90204  7788 ?        Ssl  14:59   0:00 /usr/lib/systemd/s
systemd+     657  0.0  1.8  18280  8524 ?        Ss   14:59   0:00 /usr/lib/systemd/s
root         713  0.0  1.5  26988  7200 ?        Ss   14:59   0:00 /usr/lib/systemd/s
root         714  0.0  0.0      0     0 ?        S    14:59   0:00 [psimon]
root         838  0.0  0.6   7324  2924 ?        Ss   14:59   0:00 /usr/sbin/cron -f 
message+     839  0.0  0.9   7384  4376 ?        Ss   14:59   0:00 @dbus-daemon --sys
root         852  0.0  1.8  17408  8524 ?        Ss   14:59   0:00 /usr/lib/systemd/s
root         854  0.0  2.2 468224 10660 ?        Ssl  14:59   0:00 /usr/libexec/udisk
root         888  0.0  0.5   7184  2448 ttyS0    Ss+  14:59   0:00 /sbin/agetty -o -p
root         904  0.0  0.4   7140  2264 tty1     Ss+  14:59   0:00 /sbin/agetty -o -p
root         918  0.0  3.0 110912 14444 ?        Ssl  14:59   0:00 /usr/bin/python3 /
syslog       962  0.0  0.9 220088  4604 ?        Ssl  14:59   0:00 /usr/sbin/rsyslogd
root        1167  0.0  0.0      0     0 ?        I<   15:00   0:00 [kworker/R-tls-str
root        1656  0.0  0.0      0     0 ?        S    15:00   0:00 [psimon]
root        1658  0.0  0.4 1231860 2004 ?        Ssl  15:00   0:00 /opt/digitalocean/
root        1754  0.0  1.3  13308  6392 ?        Ss   15:00   0:00 sshd: /usr/sbin/ss
root        1755  0.0  1.9  16492  8952 ?        Ss   15:00   0:00 sshd: root@pts/0
root        1759  0.0  2.5  20356 11840 ?        Ss   15:00   0:00 /usr/lib/systemd/s
root        1760  0.0  0.7  20176  3328 ?        S    15:00   0:00 (sd-pam)
root        1765  0.0  0.0      0     0 ?        S    15:00   0:00 [psimon]
root        1894  0.0  1.1   9812  5600 pts/0    Ss   15:00   0:00 -bash
root        1979  0.0  0.0      0     0 ?        I    15:10   0:00 [kworker/0:2-event
root        2008  0.0  0.0      0     0 ?        I    15:15   0:00 [kworker/u4:2-even
root        2210  0.0  0.0      0     0 ?        I    15:16   0:00 [kworker/0:0-cgwb_
polkitd     3276  0.0  1.6 305852  7596 ?        Ssl  15:16   0:00 /usr/lib/polkit-1/
root        3288  0.0  2.6 389864 12436 ?        Ssl  15:16   0:00 /usr/sbin/ModemMan
root        3379  0.0  0.8  10088  3916 ?        S    15:17   0:00 /usr/sbin/CRON -f 
root        3380  0.0  0.3   2864  1684 ?        Ss   15:17   0:00 /bin/sh -c cd / &&
root        3381  0.0  0.3   2752  1464 ?        S    15:17   0:00 run-parts --report
root        3382  0.0  0.3   2864  1684 ?        S    15:17   0:00 /bin/sh /etc/cron.
root        3383  0.0  0.7   7964  3500 ?        S    15:17   0:00 /bin/bash /opt/dig
root        3384  0.0  0.3   6176  1864 ?        S    15:17   0:00 sleep 488
root        3400  0.0  0.9   9932  4596 pts/0    S    15:17   0:00 su dev
dev         3401  0.0  1.2   9780  5848 pts/0    S    15:17   0:00 bash
root        3414  0.0  0.0      0     0 ?        I    15:20   0:00 [kworker/0:3-cgrou
root        3417  0.0  0.0      0     0 ?        I    15:22   0:00 [kworker/u4:3]
dev         3430  0.0  0.9  10192  4616 pts/0    R+   15:24   0:00 ps -aux
```

## Metodología

- Herramientas utilizadas
**dd y gzip**

- Comandos y parametros usados

```bash
ssh root@157.230.28.241 "sudo dd if=/dev/vda bs=4M | gzip -c" > vps_backup.img.gz
```

## Integridad de la imagen

- Hash de la extracción
**a66de1094eb01204655712c456a2f99bffe0e6ea106975b49ea3c2e35722a04f**

## Firma de la imagen

- Algoritmo de hash usado
**SHA-256**
- Metodo de firma digital
**RSA con clave privada de 4096 bits y usamos OpenSSL para firmar la imagen con una clave privada.**
- Clave publica del firmante
```plaintext
-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAis+MHMHOCVDXQTGgok44
Rk3syjoyaEodzUDcpVEOm7hYajvTTZUbaibuGCvitH8UPBwlyyhdKGHNWhbK2t+9
N4uuGJMfVkuWUQ6SIzbADCsPdfTOQ7PgomfE3asL/WGK9SIdZfsK3LwzFuGgOwFs
sk/yQ5t0h0Z7gY7shEbNcQDXIDlMP3WxgDXshL5rzwBVQIeKuamTpuzpbZ45Ht24
yJ5wPlAvWsgCnJZQ7qmJMYpb5LEZ3oI26HzyTf18kb7et4oMDjzP9NPQyh/MXmNR
Izsb8Y17lXRfzIhZXNPkpqrG1A6XQyKhqAGV8WMXMd5JCBQn7wFh+UGNBv/UdlBM
Zp9J5Vqf6RuVEYugnIjU4wuk/Nc1YF9Az0Wr4d4qDzYnqZCl8qEIEuouZmGdFbjp
HZ29Z0QgVS2sDx9lq6NDbCdP0o1x3rvrfQlttUUBjtbKFn937igwWiXGEZGZPlBv
ldqq3x3VWIzswWB+xsXi528WnBM5GHhCxJc16Q4HsFk6vdllNGsM1/PBNzwu8DBV
oI/USLeSez8vEiPARp2ce2eOluWlspOSDkCRE7OfEJkqFqOSqOv/kgQa+rg5CuKg
DivDDxDpGdTNxadIpEpe8LqfIpgmvF+5aJdmYqB8L2VDXtdtOtrAuoGfsGeEmbA3
qOcua3fQ0bIzWus5iCEYESECAwEAAQ==
-----END PUBLIC KEY-----
```
- Comandos usados para la firma

Primero creamos unas claves RSA para firmar el archivo. 

```bash
openssl genpkey -algorithm RSA -out privada.pem -pkeyopt rsa_keygen_bits:4096
openssl rsa -pubout -in privada.pem -out publica.pem
```

Ahora firmamos el archivo con la clave privada. 

```bash
openssl dgst -sha256 -sign privada.pem -out firma.bin archivo.txt
```

El archivo `firma.bin` contiene la firma digital del archivo `archivo.txt`.

Para verificar la firma, primero tenemos que calcular el hash del archivo original y luego verificar la firma con la clave pública.

```bash
openssl dgst -sha256 -verify publica.pem -signature firma.bin archivo.txt
```

Si la firma es válida, el comando devolverá `Verified OK`. Si no, devolverá `Verification Failure`.

Para ver el contenido de la firma, podemos usar el siguiente comando:

```bash
openssl asn1parse -inform DER -in firma.bin
```

- Ubicacion de los archivos de firma y hash
**/home/kali/extracionimg**

